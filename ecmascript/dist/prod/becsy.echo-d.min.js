"use strict";!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.echoD=e():t.echoD=e()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(()=>(Object("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).webpackChunkechoD=Object("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).webpackChunkechoD||[]).push([[565],{437:(t,e,s)=>{s.a(t,(async(t,n)=>{try{s.r(e),s.d(e,{BecsyStorage:()=>r});var o=s(699),i=s(464);const{World:t}=await s.e(453).then(s.bind(s,453));class r extends o.Ke{constructor(e,s){super({...e||{},actors:new Map,components:new Map,entities:new Map,inputs:null},s);const{worldOptions:n}=s;this.world=e?.world||t.create(n),this.eids=e?.eids||new Map}destroyActor(t){return this.destroyId(this.actors,t)}destroyComponent(t,e){const s=this.actors.get(t)||this.entities.get(t),n=this.components.get(e);if(!s||!n)return;const o=()=>{const s=this.fetchComponent(t,e);if(this.indexes[e]){const n=this.indexes[e];this.isActor(t)?n.actors.remove(t,s):n.entities.remove(t,s)}};n instanceof Map?(n.get(s)&&n.delete(s),o()):o()}destroyEntity(t){return this.destroyId(this.entities,t)}destroyId(t,e){return!!t.get(e)&&(t.delete(e),!0)}fetchComponents(t){const e=this.actors.get(t)||this.entities.get(t);if(e)return e}fetchComponent(t,e){const s=this.actors.get(t)||this.entities.get(t),n=this.components.get(e);if(s&&n)return n instanceof Map?n.get(s):void 0}getActors(t,e){if(null!==t)return super.getActors(t,e);const s=Array.from(this.actors.keys());return(0,i.paginate)(s,e)}getComponents(t,e){let s;if(null!==t)s=t;else{const t=Array.from(this.actors.keys()),e=Array.from(this.entities.keys());s=t.concat(e)}return(0,i.paginate)(s,e).map((t=>{const e={};for(let s of t)e[s]=this.actors.get(s)||this.entities.get(s);return e}))}getEntities(t,e){if(null!==t)return super.getEntities(t,e);const s=Array.from(this.entities.keys());return(0,i.paginate)(s,e)}getInputs(t,e){return super.getInputs(t,e)}isActor(t){return this.actors.has(t)}isEntity(t){return this.entities.has(t)}setActors(t){return super.setActors(t)}setComponents(t){return super.setComponents(t)}setEntities(t){return super.setEntities(t)}setInputs(t){return super.setInputs(t)}storeActor(t){return this.storeId(this.actors,t)}storeComponent(t,e,s){const n=this.actors.get(t)||this.entities.get(t);if(n){const o=n[e],i=this.types[e][3],r={};let c=0;for(let t in i)r[t]=s[c],c++;if(this.world.addComponent(n,e,r),this.indexes[e]){const n=this.indexes[e];this.isActor(t)?(n.actors.remove(t,o),n.actors.set(t,s)):(n.entities.remove(t,o),n.entities.set(t,s))}}}storeEntity(t){return this.storeId(this.entities,t)}storeId(t,e){const s=t.get(e);return!s&&(t.set(e,s),this.world.add(s),!0)}storeInput(t,e,s=Date.now()){return super.storeInput(t,e,s)}}n()}catch(t){n(t)}}),1)}},t=>(437,t(t.s=437))])));
//# sourceMappingURL=becsy.echo-d.min.js.map