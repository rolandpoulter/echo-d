!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.echoD=e():t.echoD=e()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(()=>(()=>{"use strict";var t={d:(e,n)=>{for(var s in n)t.o(n,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:n[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{Actions:()=>x,Actor:()=>s,ArrayTypes:()=>ct,BasicTypes:()=>rt,Changes:()=>T,Client:()=>a,CommonComponents:()=>I,Component:()=>o,Context:()=>Tt,Core:()=>i,DefaultSymbols:()=>E,Emitter:()=>Q,Entitity:()=>r,Handler:()=>gt,Index:()=>M,IndexMap:()=>lt,Node:()=>l,Options:()=>Mt,Ordered:()=>qt,Pending:()=>Ft,SortedIndex:()=>q,SpatialIndex:()=>F,Storage:()=>ut,Symbol:()=>c,Symbols:()=>H,batchActionPayloadSizes:()=>U,createStorageProps:()=>at,default:()=>Nt,defaultGetActorId:()=>G,defaultGetGroupedValue:()=>V,defaultOptions:()=>j,defaultSetGroupedValue:()=>L,defaultUpdateOptions:()=>R,defaultValidKeys:()=>z,ensureSymbolIndex:()=>N,enumActions:()=>O,enumCommonComponents:()=>k,enumDefaultSymbols:()=>D,extractSymbol:()=>K,getActionHandler:()=>pt,getSymbolAction:()=>ht,handler:()=>ft,manyHandler:()=>yt,oneHandler:()=>dt,padEnum:()=>P,recursiveSymbolExtraction:()=>B,recursiveSymbolIndexesEnsured:()=>$,updater:()=>mt,utils:()=>n,voidResponder:()=>_});var n={};t.r(n),t.d(n,{binaryInsert:()=>y,binarySearch:()=>g,combineValues:()=>v,concatTypedArray:()=>m,createEnum:()=>b,differenceSets:()=>d,intersectionSets:()=>f,messageTuple:()=>S,now:()=>u,paginate:()=>A,recursiveCombination:()=>w,typeOf:()=>C,unionSetOrArray:()=>h,unionSets:()=>p});var s={};t.r(s),t.d(s,{ActorActions:()=>W,ActorActionsFactory:()=>J,actions:()=>Y,default:()=>Z});var o={};t.r(o),t.d(o,{ComponentActions:()=>et,ComponentActionsFactory:()=>tt,actions:()=>st,default:()=>ot});var i={};t.r(i),t.d(i,{CoreActions:()=>At,CoreActionsFactory:()=>St,actions:()=>Ct,default:()=>vt});var r={};t.r(r),t.d(r,{EntityActions:()=>xt,EntityActionsFactory:()=>wt,actions:()=>Et,default:()=>Pt});var c={};t.r(c),t.d(c,{SymbolActions:()=>kt,SymbolActionsFactory:()=>Ot,actions:()=>Ut,default:()=>jt});var l={};t.r(l),t.d(l,{AllActionsFactory:()=>Rt,NodeActions:()=>_t,actions:()=>Vt,allActions:()=>zt,default:()=>Lt});var a={};function u(){return performance.timeOrigin+performance.now()}function m(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(Array.isArray(t)){const n=new e.constructor(t.length);n.set(t),t=n}else if(Array.isArray(e)){const n=new t.constructor(e.length);n.set(e),e=n}const n=new t.constructor(t.length+e.length);return n.set&&(n.set(t),n.set(e,t.length)),n}function h(...t){const e={};for(const n of t)if(n)for(const t of n)e[t]=!0;return Object.keys(e)}function p(t,e){if("function"==typeof t.union)return t.union(t);const n=new Set;for(const e of t)n.add(e);for(const t of e)n.add(t);return n}function d(t,e){if("function"==typeof t.difference)return t.difference(t);const n=new Set;for(const s of t)e.has(s)||n.add(s);return n}function f(t,e){if("function"==typeof t.intersection)return t.intersection(t);const n=new Set;for(const s of t)e.has(s)&&n.add(s);return n}function y(t,e,n=(t=>t)){let s=0,o=t.length;for(;s<o;){const i=s+o>>>1;n(t[i])<e?s=i+1:o=i}return s}function g(t,e,n=(t=>t)){let s=0,o=t.length-1;for(;s<=o;){const i=s+o>>>1,r=n(t[i]);if(r===e)return[i,s];r<e?s=i+1:o=i-1}return[-1,s]}function b(t,e=0){const n={};let s=e;if(t)for(const e of t)n[e]=s++;return n}function S(t){return[t?.action,t?.payload]}function A(t,e){if(e===1/0&&Array.isArray(t)&&t.length>0)return[t];const n=[];let s=[],o=0;for(const i of t)o>=e&&(n.push(s),s=[],o=0),s.push(i),o++;return s.length>0&&n.push(s),n}function C(t){const e=typeof t;if("object"===e){if(!t)return"null";if(Array.isArray(t))return"array"}return e}function v(t,e){return w(t,e)}function w(t,e){const n=C(t);switch(C(e)){case"bigint":case"number":return"number"!==n&&"bigint"!==n?[!1,e]:[!0,t+e];case"array":{if("array"!==n)return[!1,e];const s=[];let o=!0;for(let n=0;n<e.length;n+=1){const[i,r]=w(t[n],e[n]);s[n]=r,!1===i&&(o=!1)}return[o,s]}case"object":{if("object"!==n)return[!1,e];const s={};let o=!0;for(const n in e){const[i,r]=w(t[n],e[n]);!1===i&&(o=!1),s[n]=r}return[o,s]}default:return[!1,e]}}t.r(a),t.d(a,{ClientActions:()=>Qt,actions:()=>Ht,default:()=>Kt});const x=["actorInput","actors","addSymbol","batch","changeComponent","components","createEntity","entities","fetchSymbol","getSymbol","mergeActors","mergeComponents","mergeEntities","mergeSymbols","mergeSymbol","removeActor","removeComponent","removeEntity","spawnActor","symbol","symbols","upsertComponent"],I=["asset","collider","color","hidden","position","rotation","velocity","spin"],E=h(x,I),P=0,O=b(x,P),k=b(I,x.length+P),D=b(E,P),U={actorInput:{default:1,rollback:2},changeComponent:{default:3,ordered:4},mergeSymbols:2,removeComponent:2,upsertComponent:{default:3,ordered:4}},j={compressStringsAsInts:!0,enableRollback:!1,enableQuerying:!1,isAuthority:!0,isAsyncStorage:!1,isComponentRelay:!0,isDiffed:!1,isGroupedComponents:!1,isOrdered:!1,isReadOnly:!1,isSymbolLeader:!1,isSymbolRelay:!1,pageSize:100,skipPending:!1,indexes:{position:{type:"spatial"}},types:{asset:"str",collider:"str",color:["ui8",4],hidden:"bool",position:["f32",3],rotation:["f32",3],velocity:["f32",3],spin:["f32",3],size:["f32",3]}},R={mask:{actors:!0,entities:!0,components:!0,inputs:!0,symbols:!0}&&null,type:!0,batched:!0,batchSize:100},z={asset:!0,collider:!0,color:!0,hidden:!0,position:!0,rotation:!0,velocity:!0,spin:!0,size:!0};function _(){}function G(t,e){return t}function V(t,e,n,s){const o=n[s];return Array.isArray(o)?t.slice(e*o[1],(e+1)*o[1]):t[e]}function L(t,e,n){return t}class M{items;constructor(t=null,e={}){this.items=t}clear(){this.items=null}clone(){return new M(this.items)}get(t){}has(t,e){return!1}remove(t,e){}set(t,e){return null}store(t,e,n){return e&&this.remove(e,t),this.set(n,t)}query(t){return[]}}class q extends M{constructor(t=[],e={}){super(t)}clear(){this.items=[]}clone(){return new q(this.items)}get(t){const e=this.items.find((e=>e[0]===t));return e?e[1]:[]}has(t,e){const n=this.items.find((e=>e[0]===t));return void 0===e?!!n:!!n&&-1!==n[1].indexOf(e)}remove(t,e){const n=function(t,e,n){const s=y(t,e,(t=>t[0])),o=t[s];if(o[0]===e){const e=o[1],i=e.lastIndexOf(n);if(-1!==i)return e.splice(i,1),0===e.length&&t.splice(s,1),[s,i]}return[-1,-1]}(this.items,t,e);return n}set(t,e){const n=function(t,e,n){const s=y(t,e,(t=>t[0])),o=t[s];if(o[0]!==e){const o=[n];return t.splice(s,0,[e,o]),[s,0]}{const t=o[1];if(-1===t.indexOf(n))return t.push(n),[s,t.length-1]}return[-1,-1]}(this.items,t,e);return n}query(t){return this.get(t)}}class F extends M{constructor(t=[],{cellSize:e=5}={}){super(t),this.cellSize=e}clear(){this.items=[]}clone(){return new F(this.items)}get(t){const e=this.hash(t);this.items[e]=this.items[e]||[];return this.items[e]||[]}has(t,e){const n=this.hash(t);this.items[n]=this.items[n]||[];const s=this.items[n];return void 0===e?!!s:!!s&&-1!==s.indexOf(e)}hash(t){return 2===t.length?this.hash2d(t[0],t[1]):this.hash3d(t[0],t[1],t[2])}hash2d(t=0,e=0){return 73856093*Math.floor((t+1e3)/this.cellSize)^19349663*Math.floor((e+1e3)/this.cellSize)}hash3d(t=0,e=0,n=0){return 73856093*Math.floor((t+1e3)/this.cellSize)^19349663*Math.floor((e+1e3)/this.cellSize)^83492791*Math.floor((n+1e3)/this.cellSize)}remove(t,e){const n=this.hash(t);this.items[n]=this.items[n]||[];const s=this.items[n],[o]=g(s,e);return-1===o&&s.splice(o,1),0===s.length&&delete this.items[n],[n,o]}set(t,e){const n=this.hash(t);this.items[n]=this.items[n]||[];const s=this.items[n],[o,i]=g(s,e);return-1===o&&s.splice(i,0,e),[n,o]}query(t){let e=[];const n=this.cellSize;if(2==(2===t.length?2:3)){const[s,o]=t;for(let t=2*-n;t<2*n+n;t+=n)for(let i=2*-n;i<2*n+n;i+=n){const n=this.items[this.hash2d(s+t,o+i)];void 0!==n&&(e=e.concat(n))}}else{const[s,o,i]=t;for(let t=2*-n;t<2*n+n;t+=n)for(let r=2*-n;r<2*n+n;r+=n)for(let c=2*-n;c<2*n+n;c+=n){const n=this.items[this.hash3d(s+t,o+r,i+c)];void 0!==n&&(e=e.concat(n))}}return e}}class T{context;diffs;constructor(t,e){this.context=t,this.diffs=e?.diffs||{}}changeComponent(t,e,n,s,o=!1){return this.upsertComponent(t,e,n,s,o)}getValue(t,e,n){const s=this.diffs[t]?.[e];return null==s?n:s}reset(t){return this.diffs=t?.diffs||{},this}upsertComponent(t,e,n,s,o=!1){this.diffs[t]=this.diffs[t]||{};const i=this.context.store.findComponents(t),r=[],c=s=>{if(null==s){this.diffs[t][e]=n;const s=this.context.store.storeComponent(t,e,n);return o&&s instanceof Promise&&r.push(s),n}let i=this.diffs[t];const c=(t,e,n,s)=>{let o=s;if(!n)return[e,o];const i=C(n[t]),r=C(o);if(i!==r)return e[t]=o,[e=e[t],o];switch(r){case"bigint":case"number":{const s=o-n[t];e[t]=s;break}case"array":e=e[t],n=n[t];for(let t=0;t<o.length;t+=1)c(t.toString(),e,n,o[t]);break;case"object":e=e[t],n=n[t];for(const t in o)c(t,e,n,o[t]);break;default:e[t]=o}return e=e[t],o=o[t],[e,s]};[i,n]=c(e,i,s,n);const l=this.context.store.storeComponent(t,e,n);return o&&l instanceof Promise&&r.push(l),n};return o&&i instanceof Promise?new Promise(((t,e)=>{i.then((s=>(c(s),0===r.length?Promise.all(r).then((()=>t(n)),e):t(n))))})):c(i)}}class Q{handlers;emissions;handlersDone;emissionsDone;constructor(t=[],e=!1,n=[],s=!1){this.handlers=n,this.emissions=t;for(const t of this.handlers)for(const e of this.emissions)t(e);this.handlersDone=e,this.emissionsDone=s,this.cleanup()}cleanup(){this.handlersDone&&this.emissionsDone&&this.clear()}clear(){this.handlers=[],this.emissions=[],this.handlersDone=!1,this.emissionsDone=!1}done(t=!0,e=!0){this.handlersDone=t,this.emissionsDone=e,this.cleanup()}emitTo(t,e=!1){this.handlers.push(t);for(const e of this.emissions)t(e);this.handlersDone=e,this.cleanup()}emit(t,e=!1){this.emissions.push(t);for(const e of this.handlers)e(t);this.emissionsDone=e,this.cleanup()}removeHandler(t){const e=this.handlers.indexOf(t);-1!==e&&this.handlers.splice(e,1)}removeEmission(t){const e=this.emissions.indexOf(t);-1!==e&&this.emissions.splice(e,1)}}class H{_list;_enum;constructor(t={}){const{_list:e=[]}=t;this._list=e,this._enum=b(e)}add(t){if(t){if(Object.prototype.hasOwnProperty.call(this._enum,t))return this._enum[t];{const e=this._list.length;return this._list[e]=t,this._enum[t]=e,e}}return null}copyEnum(t={}){for(const e of Object.entries(t))this.merge(e)}fetch(t){let e,n;switch(typeof t){case"number":e=t,n=this._list[e]||"";break;case"string":n=t,e=Object.prototype.hasOwnProperty.call(this._enum,n)?this._enum[n]:-1}return[n,e]}find(t){return this._enum[t]}get(t){return this._list[t]}getSymbols(){return this._list}getSymbolsEnum(){return this._enum}merge(t){const[e,n]=t;this._list[n]=e,this._enum[e]=n}reset(t,e=[]){if(t>0){const{length:n}=e,{_list:s}=this,{_enum:o}=this;for(let i=0;i<n;i++){const n=e[i],r=i+t;s[r]=n,o[n]=r}}else this._list=e,this._enum=b(e)}}function K(t,e,n){if("number"==typeof t){const{actions:s}=n,{getSymbol:o}=s,i=o(t,e,n);if(!i)return"";t=i}return t}function N(t,e,n){if("string"==typeof t){const{actions:s}=n,{addSymbol:o}=s,i=o(t,e,n);if("number"==typeof i)return i}return t}function B(t,e,n,s){if("$"===t.charAt(0)){const{actions:t}=s,{getSymbol:o}=t,i=t=>{if(!Array.isArray(t)){switch(typeof t){case"number":{const e=o(t,n,s);e&&(t=e);break}case"object":for(const e in t)t[e]=i(t[e])}return t}t=t.map(i)};return i(e)}return e}function $(t,e,n,s){if("$"===t.charAt(0)){const{actions:t}=s,{addSymbol:o}=t,i=t=>{if(!Array.isArray(t)){switch(typeof t){case"string":{const e=o(t,n,s);"number"==typeof e&&(t=e);break}case"object":for(const e in t)t[e]=i(t[e])}return t}t=t.map(i)};return i(e)}return e}const J=(t=Object)=>class extends t{actorInput(t,e,n){n=Mt.ensure(n,this);const{getActorId:s,compressStringsAsInts:o}=n;let i,r=0;Array.isArray(t)?(i=t[0],r=t[1]||0):i=t;let c=s(i?.id,e);null!=c&&""!==c&&(o&&(c=K(c,e,n),""===c)||(i?.id||(i.id=c),e.actorInput(c,i,r,n)))}actors(t,e,n){n=n=Mt.ensure(n,this);const{responder:s,isAuthority:o,isAsyncStorage:i,pageSize:r,enableQuerying:c,enumDefaultSymbols:l}=n;if(!o)return;const a=t=>{for(const e of t)s([l.mergeActors,e])},u=e.getActors(c?t:null,r);i?u.emitTo(a,!0):a(u)}mergeActors(t,e,n){n=n=Mt.ensure(n,this),e.mergeActors(t,n)}removeActor(t,e,n){n=n=Mt.ensure(n,this);const{skipPending:s,getActorId:o,compressStringsAsInts:i}=n;null!=(t=o(t,e))&&""!==t&&(i&&""===(t=K(t,e,n))||e.removeActor(t,s))}spawnActor(t,e,n){n=n=Mt.ensure(n,this);const{skipPending:s,getActorId:o,compressStringsAsInts:i}=n;null!=(t=o(t,e))&&""!==t&&(i&&""===(t=K(t,e,n))||e.spawnActor(t,s))}};class W extends(J()){}const X=new W,Y={actorInput:X.actorInput,actors:X.actors,mergeActors:X.mergeActors,removeActor:X.removeActor,spawnActor:X.spawnActor},Z=Y,tt=(t=Object)=>class extends t{changeComponent(t,e,n){n=n=Mt.ensure(n,this);const{compressStringsAsInts:s,types:o,isOrdered:i}=n;let[r,c,l]=t,a=i?t[3]:0;if(null!=r&&""!==r&&null!=c&&""!==c){if(s){if(r=K(r,e,n),!r)return;if(c=K(c,e,n),!c)return;const t=o[c];if(t&&(t===String||t[0]===String)&&(l=B(c,l,e,n),!l))return}return e.changeComponent(r,c,l,a,n)}}components(t,e,n){n=n=Mt.ensure(n,this);const{responder:s,isAuthority:o,isAsyncStorage:i,pageSize:r,enableQuerying:c,enumDefaultSymbols:l}=n;if(!o)return;const a=t=>{for(const e of t)s([l.mergeComponents,e])},u=e.getComponents(c?t:null,r);i?u.emitTo(a,!0):a(u)}mergeComponents(t,e,n){n=n=Mt.ensure(n,this),e.mergeComponents(t,n)}removeComponent(t,e,n){n=n=Mt.ensure(n,this);const{compressStringsAsInts:s}=n;let[o,i]=t;if(null!=o&&""!==o&&null!=i&&""!==i){if(s){if(o=K(o,e,n),!o)return;if(i=K(i,e,n),!i)return}e.removeComponent(o,i,n)}}upsertComponent(t,e,n){n=n=Mt.ensure(n,this);const{compressStringsAsInts:s,types:o,isOrdered:i}=n;let[r,c,l]=t,a=i?t[3]:0;if(null!=r&&""!==r&&null!=c&&""!==c){if(s){if(r=K(r,e,n),!r)return;if(c=K(c,e,n),!c)return;const t=o[c];if(t&&(t===String||t[0]===String)&&(l=B(c,l,e,n),!l))return}return e.upsertComponent(r,c,l,a,n)}}};class et extends(tt()){}const nt=new et,st={changeComponent:nt.changeComponent,components:nt.components,mergeComponents:nt.mergeComponents,removeComponent:nt.removeComponent,upsertComponent:nt.upsertComponent},ot=st;class it extends M{constructor(t={},e={}){super(t)}clear(){this.items={}}clone(){return new M(this.items)}get(t){return this.items[t]}has(t,e){const n=this.items[t];return!(!n||!n.has(e))}remove(t,e){const n=this.items[t];if(n&&n.has(e))return n.delete(e),!0}set(t,e){return this.items[t]=this.items[t]||new Set,!this.items[t].has(e)&&(this.items[t].add(e),!0)}union(t,e){return new it({...this.items,[t]:p(this.items[t],e.items[t])})}difference(t,e){return new it({...this.items,[t]:d(this.items[t],e.items[t])})}intersection(t,e){return new it({...this.items,[t]:f(this.items[t],e.items[t])})}query(t){const{with:e,without:n}=t||{};let s=new Set;if(e)for(const t of e){const e=this.items[t];e&&(s=p(s,e))}if(n)for(const t of n){const e=this.items[t];e&&(s=d(s,e))}return s}}const rt=new Map([["str",String],["num",Number],["bool",Boolean],["map",Map],["set",Set],["arr",Array]]),ct=new Map([["i8",Int8Array],["ui8",Uint8Array],["ui8c",Uint8ClampedArray],["i16",Int16Array],["ui16",Uint16Array],["i32",Int32Array],["ui32",Uint32Array],["f32",Float32Array],["f64",Float64Array]]),lt={sorted:q,spatial:F};function at(t={},e={},n={}){const{actors:s=[],entities:o=[],components:i={},inputs:r={}}=e||{},{types:c={},indexes:l={}}=n;t.actors=s||[],t.entities=o||[],t.components=i||{},t.inputs=r||{},t.types=c,t.typeCtors={};for(let e in c){let n=c[e];Array.isArray(n)?n=rt.get(n[0])||ct.get(n[0]):"string"==typeof n&&(n=rt.get(n)||ct.get(n)),"function"==typeof n&&n&&(t.typeCtors[e]=n)}t.componentsIndex=new it,t.indexes={};for(let e in l){const{type:n}=l[e],s=lt[n];s&&(t.indexes[e]={actors:new s([],l[e]),entities:new s([],l[e])})}return t}class ut{constructor(t={},e={}){at(this,t,e)}destroyActor(t){const e=this.actors;return this.destroyId(e,t)}destroyComponent(t,e){const n=this.components[t][e];delete this.components[t][e],this.removeComponentsIndex(t,e,n)}destroyEntity(t){const e=this.entities;return this.destroyId(e,t)}destroyId(t,e){const[n]=g(t,e);return-1!==n&&(t.splice(n,1),!0)}findComponents(t){return this.components[t]=this.components[t]||{},this.components[t]}findComponent(t,e){return this.components[t]=this.components[t]||{},this.components[t][e]}findInputs(t){return this.inputs[t]}findInput(t,e){this.inputs[t]=this.inputs[t]||[];const n=this.inputs[t][e];return Array.isArray(n)?[{...n[0],id:t},n[1]]:{...n,id:t}}getActors(t=null,e=1/0){if(null!==t){let n={};for(let e in t){const s=this.indexes[e];s&&s.actors.query(t[e]).forEach((t=>{n[t]=!0}))}return A(Object.keys(n),e)}return A(this.actors,e)}getComponents(t=null,e=1/0){let n=this.components;if(null!==t){const e={};for(let n of t)e[n]=this.components[n];n=e}return A(Object.keys(n),e).map((t=>{const e={};for(let s of t)e[s]=n[s];return e}))}getEntities(t=null,e=1/0){if(null!==t){let n={};for(let e in t){const s=this.indexes[e];s&&s.entities.query(t[e]).forEach((t=>{n[t]=!0}))}return A(Object.keys(n),e)}return A(this.entities,e)}getInputs(t=null,e=1/0){let n=this.inputs;if(null!==t){const e={};for(let n of t)e[n]=this.inputs[n];n=e}return A(Object.keys(n),e).map((t=>{const e={};for(let s of t)e[s]=n[s];return e}))}isActor(t){return-1!==this.actors.indexOf(t)}isEntity(t){return-1!==this.entities.indexOf(t)}setActors(t){return this.actors=t,t}setComponents(t){return this.components=t,t}setEntities(t){return this.entities=t,t}setInputs(t){return this.inputs=t,t}storeActor(t){const e=this.actors;return this.storeId(e,t)}storeComponent(t,e,n){const s=this.components[t][e];this.components[t][e]=n,this.updateComponentsIndex(t,e,s,n)}storeEntity(t){const e=this.entities;return this.storeId(e,t)}storeId(t,e){const[n,s]=g(t,e);return-1===n&&(t.splice(s,0,e),!0)}storeInput(t,e,n=0){const s=this.inputs;s[t]=s[t]||[];const o=s[t].length;return e.id===t&&delete e.id,s[t].push(n?[e,n]:e),o}queryComponents(t){return this.componentsIndex.query(t)}removeComponentsIndex(t,e,n){if(this.componentsIndex.remove(t,e),this.indexes[e]){const s=this.indexes[e];this.isActor(t)?s.actors.remove(t,n):s.entities.remove(t,n)}}updateComponentsIndex(t,e,n,s){if(this.componentsIndex.set(t,e),this.indexes[e]){const o=this.indexes[e];this.isActor(t)?o.actors.store(t,n,s):o.entities.store(t,n,s)}}}async function mt(t,e,n=u()){e=e instanceof Mt?e:new Mt(e);const{responder:s,enumDefaultSymbols:o,compressStringsAsInts:i,enableRollback:r,isOrdered:c,isDiffed:l,isGroupedComponents:a,isAsyncStorage:h,types:p,setGroupedValue:d,updateOptions:f}=e,{batched:y,batchSize:g,mask:b,type:S,validKeys:A}=f;if(!t.pending)return[];const C=[];let v=[];const{created:w={},removed:x={},symbols:I=[],updated:E={}}=t.pending,P=t.store,O=t=>{y&&v.length&&(C.push([t,...v]),v=[])},k=(n,o)=>{y?(v=v.concat(o),v.length>=g&&O(n)):(i&&(n=N(n,t,e)),s([n,o],S))},D=n=>(i&&(n=N(n,t,e)),n),U=async(s={},r)=>{const u=a?{}:null;for(const a in s??{}){if(!(h?await P.findComponents(a):P.findComponents(a)))break;const f=s?s[a]:{};for(const s in f??{}){if(A&&!A[s])break;const f=p[s]??null,y=f?ct.get(Array.isArray(f)?f[0]:f):null;let g=null;u&&(g=u[s]=u[s]??{key:s,ids:i?new Uint32Array(0):[],intIds:!0,values:y?new y(0):[],ticks:new Uint32Array(0)});let b=h?await P.findComponent(a,s):P.findComponent(a,s);l&&t.changes&&"updated"===r&&(b=t.changes.getValue(a,s,b)),i&&(b=$(s,b,t,e));const S=D(a),C=D(s);if(u){g.ids=i?m(g.ids,[S]):g.ids.concat([a]),S===a&&(g.intIds=!1),g.values=y?m(g.values,d(b,p,s)):g.values.concat(d(b,p,s)),c&&(g.ticks=m(g.ticks,[l?-n:n]));continue}const v=[S,C,b];c&&v.push(l?-n:n),k(l?o.changeComponent:o.upsertComponent,v)}}if(u)for(const t in u){const e=u[t],n=i&&e.intIds?new Uint32Array(e.ids):e.ids,s=p[t]??null,r=s?ct.get(Array.isArray(s)?s[0]:s):null,a=r?new r(e.values):e.values;let m=0;const h=n.length;for(;m<h;m+=g){const t=[n.slice(m,m+g),e.key,a.slice(m,m+g)];if(c){const n=new Uint32Array(e.ticks.slice(m,m+g));t.push(n)}k(l?o.changeComponent:o.upsertComponent,t)}}O(l?o.changeComponent:o.upsertComponent)};if(!b||!b.entities){for(const t of w.entities??[]){const e=D(t);k(o.createEntity,e)}O(o.createEntity),w.entities=[]}if(!b||!b.actors){for(const t in w.actors??{}){const e=D(t);k(o.spawnActor,e)}O(o.spawnActor),w.actors={}}if(!b||!b.entities){for(const t of x.entities??[]){const e=D(t);k(o.removeEntity,e)}O(o.removeEntity),x.entities=[]}if(!b||!b.actors){for(const t in x.actors??{}){const e=D(t);k(o.removeActor,e)}O(o.removeActor),x.actors={}}if(!b||!b.components){for(const t in x.components??{}){const e=x?.components?x.components[t]:null;if(!e)break;const n=D(t);for(const t in e){if(A&&!A[t])break;const e=[n,D(t)];k(o.removeComponent,e)}}O(o.removeComponent),x.components={}}if(!b||!b.components){const t=U(w.components,"created");w.components={},await t}if(!b||!b.components){const t=U(E.components,"updated");E.components={},await t}if(!b||!b.inputs){for(const t in w.inputs??{}){const e=w?.inputs?w.inputs[t]??[]:[];for(let s=0;s<e.length;s+=1){const i=e[s],c=h?await P.findInput(t,i):P.findInput(t,i),l=Array.isArray(c),a=l?c[0]:c,u=l?c[1]:n;k(o.actorInput,l||r?[a,u]:a)}}O(o.actorInput),w.inputs={}}if(!b||!b.symbols){for(const t of I){if(y)v.push(t);else{const e=[o.mergeSymbol,t];await s(e,S)}v.length>=g&&v.length&&(C.unshift([o.mergeSymbol].concat(v)),v=[])}y&&v.length&&(C.unshift([o.mergeSymbol].concat(v)),v=[]),t.pending.symbols=[]}if(y&&C.length)for(let t=0;t<C.length;t+=1){const e=C[t];e&&await s([o.batch,e])}return C}function ht(t,e){return e&&"number"==typeof t&&e[t]&&(t=e[t]),t}function pt(t,e){e=e instanceof Mt?e:new Mt(e);const{actions:n,defaultSymbols:s}=e;return o=>{o=ht(o,s);const i=s=>{n[o]&&n[o](s,t,e)};return i.action=o,i}}function dt(t,e,n){const s=pt(e,n=n instanceof Mt?n:new Mt(n));Array.isArray(t)?s(t[0])(t[1]):t&&s(t.action)(t.payload)}const ft=yt;function yt(t,e,n){n=n instanceof Mt?n:new Mt(n);const{batchActionPayloadSizes:s,isOrdered:o,enableRollback:i}=n,r=pt(e,n),c=(t,r,c=0)=>{const l=r.action;let a=s[l]||1;a&&"object"==typeof a&&(a=a.ordered&&o?a.ordered:a.rollback&&i?a.rollback:a.default);for(let o=c;o<t.length;o+=a)1===a?r(t[o],e,n):s&&r(t.slice(o,o+a),e,n)};if(Array.isArray(t))c(t,r(t[0]),1);else if(t){const e=r(t.action);c(t.payload,e)}}class gt{context;options;constructor(t,e,n,s=ut){this.options=Mt.ensure(e,n),this.context=Tt.ensure(t,e,s)}one(t,e){return dt(t,this.context,e?this.options.extend(e):this.options)}many(t,e){return yt(t,this.context,e?this.options.extend(e):this.options)}getActionHandler(){return pt(this.context,this.options)}getSymbolAction(t){return ht(t,this.options.defaultSymbols)}updater(t,e=u()){return mt(this.context,t?this.options.extend(t):this.options,e)}spawnActor(t,e){return this.context.spawnActor(t,e?this.options.extend(e):this.options)}removeActor(t,e){return this.context.removeActor(t,e?this.options.extend(e):this.options)}actorInput(t,e,n=u(),s){return this.context.actorInput(t,e,n,s?this.options.extend(s):this.options)}createEntity(t,e){return this.context.createEntity(t,e?this.options.extend(e):this.options)}removeEntity(t,e){return this.context.removeEntity(t,e?this.options.extend(e):this.options)}upsertComponent(t,e,n,s=u(),o){return this.context.upsertComponent(t,e,n,s,o?this.options.extend(o):this.options)}changeComponent(t,e,n,s=u(),o){return this.context.changeComponent(t,e,n,s,o?this.options.extend(o):this.options)}removeComponent(t,e,n){return this.context.removeComponent(t,e,n?this.options.extend(n):this.options)}queryComponents(t){return this.context.store.queryComponents(t)}}const bt=gt,St=(t=Object)=>class extends t{batch(t,e,n){yt(t,e,n=n=Mt.ensure(n,this))}};class At extends(St()){}const Ct={batch:(new At).batch},vt=Ct,wt=(t=Object)=>class extends t{createEntity(t,e,n){n=n=Mt.ensure(n,this);const{skipPending:s,compressStringsAsInts:o}=n;null!=t&&""!==t&&(o&&""===(t=K(t,e,n))||e.createEntity(t,s))}entities(t,e,n){n=n=Mt.ensure(n,this);const{responder:s,isAuthority:o,isAsyncStorage:i,pageSize:r,enableQuerying:c,enumDefaultSymbols:l}=n;if(!o)return;const a=t=>{for(const e of t)s([l.mergeEntities,e])},u=e.getEntities(c?t:null,r);i?u.emitTo(a,!0):a(u)}mergeEntities(t,e,n){n=n=Mt.ensure(n,this),e.mergeEntities(t,n)}removeEntity(t,e,n){n=n=Mt.ensure(n,this);const{skipPending:s,compressStringsAsInts:o}=n;null!=t&&""!==t&&(o&&""===(t=K(t,e,n))||e.removeEntity(t,s))}};class xt extends(wt()){}const It=new xt,Et={createEntity:It.createEntity,entities:It.entities,mergeEntities:It.mergeEntities,removeEntity:It.removeEntity},Pt=Et,Ot=(t=Object)=>class extends t{addSymbol(t,e,n){return n=n=Mt.ensure(n,this),e.addSymbol(t,n)}fetchSymbol(t,e,n){n=n=Mt.ensure(n,this);const{responder:s,enumDefaultSymbols:o}=n;return e.fetchSymbol(t,n,(t=>{s([o.mergeSymbol,t])}))}getSymbol(t,e,n){return n=n=Mt.ensure(n,this),e.getSymbol(t,n)}mergeSymbol(t,e,n){n=n=Mt.ensure(n,this),e.mergeSymbol(t,n)}mergeSymbols(t,e,n){n=n=Mt.ensure(n,this);const[s,o]=t;t&&t.length&&e.resetSymbols(s,o,n)}symbol(t,e,n){n=n=Mt.ensure(n,this);const{actions:s,responder:o,isAuthority:i,enumDefaultSymbols:r,compressStringsAsInts:c}=n;if(!i||!c)return;const l=e.symbolsEnum??{};let a=Object.prototype.hasOwnProperty.call(l,t)?l[t]:-1;-1===a&&(a=s.addSymbol(t,e,n)),-1!==a&&o([r.mergeSymbol,[t,a]])}symbols(t,e,n){n=n=Mt.ensure(n,this);const{responder:s,isAuthority:o,pageSize:i,enumDefaultSymbols:r,compressStringsAsInts:c}=n;if(!o||!c)return;const l=e.symbolsList;if(l&&l.length){const t=A(l,i);let e=0;for(const n of t)s([r.mergeSymbols,e,n]),e+=i}}};class kt extends(Ot()){}const Dt=new kt,Ut={addSymbol:Dt.addSymbol,fetchSymbol:Dt.fetchSymbol,getSymbol:Dt.getSymbol,mergeSymbol:Dt.mergeSymbol,mergeSymbols:Dt.mergeSymbols,symbol:Dt.symbol,symbols:Dt.symbols},jt=Ut;function Rt(t=Object){return J(tt(St(wt(Ot(t)))))}const zt={...Z,...ot,...vt,...Pt,...jt};class _t extends(Rt()){}const Gt=new _t,Vt={actorInput:Gt.actorInput,actors:Gt.actors,mergeActors:Gt.mergeActors,removeActor:Gt.removeActor,spawnActor:Gt.spawnActor,changeComponent:Gt.changeComponent,components:Gt.components,mergeComponents:Gt.mergeComponents,removeComponent:Gt.removeComponent,upsertComponent:Gt.upsertComponent,batch:Gt.batch,createEntity:Gt.createEntity,entities:Gt.entities,mergeEntities:Gt.mergeEntities,removeEntity:Gt.removeEntity,addSymbol:Gt.addSymbol,fetchSymbol:Gt.fetchSymbol,getSymbol:Gt.getSymbol,mergeSymbol:Gt.mergeSymbol,mergeSymbols:Gt.mergeSymbols,symbol:Gt.symbol,symbols:Gt.symbols},Lt=Vt;class Mt{actions;batchActionPayloadSizes;compressStringsAsInts;defaultSymbols;enableRollback;enableQuerying;enumDefaultSymbols;getActorId;getGroupedValue;indexes;isAuthority;isAsyncStorage;isComponentRelay;isDiffed;isGroupedComponents;isOrdered;isReadOnly;isSymbolLeader;isSymbolRelay;onUpdate;pageSize;responder;skipPending;types;setGroupedValue;storeOptions;updateOptions;worldOptions;static ensure(t={},e){return t instanceof Mt?t:new Mt(t,e)}constructor(t={},e=null){const{actions:n=e||Vt,batchActionPayloadSizes:s=U,compressStringsAsInts:o=j.compressStringsAsInts,defaultSymbols:i=E,enableRollback:r=j.enableRollback,enableQuerying:c=j.enableQuerying,enumDefaultSymbols:l=D,getActorId:a=G,getGroupedValue:u=V,indexes:m=j.indexes,isAuthority:h=j.isAuthority,isAsyncStorage:p=j.isAsyncStorage,isComponentRelay:d=j.isComponentRelay,isDiffed:f=j.isDiffed,isGroupedComponents:y=j.isGroupedComponents,isOrdered:g=j.isOrdered,isReadOnly:b=j.isReadOnly,isSymbolLeader:S=j.isSymbolLeader,isSymbolRelay:A=j.isSymbolRelay,onUpdate:C=null,pageSize:v=j.pageSize,responder:w=_,skipPending:x=j.skipPending,types:I=j.types,setGroupedValue:P=L,storeOptions:O={},updateOptions:k={},worldOptions:M=null}=t,q={...R,...k};q.validKeys=k?.validKeys?{...z,...k?.validKeys||{}}:null,this.actions=n,this.batchActionPayloadSizes=s,this.compressStringsAsInts=o,this.defaultSymbols=i,this.enableRollback=r,this.enableQuerying=c,this.enumDefaultSymbols=l,this.getActorId=a,this.getGroupedValue=u,this.indexes=m,this.isAuthority=h,this.isAsyncStorage=p,this.isComponentRelay=d,this.isDiffed=f,this.isGroupedComponents=y,this.isOrdered=g,this.isReadOnly=b,this.isSymbolLeader=S,this.isSymbolRelay=A,this.onUpdate=C,this.pageSize=v,this.responder=w,this.skipPending=x,this.types=I,this.setGroupedValue=P,this.storeOptions=O,this.updateOptions=q,this.worldOptions=M}clone(){return new Mt({...this},this.actions)}extend(t,e=this.actions){return new Mt({...this,...t},e)}}class qt{order;constructor(t={}){this.order=t}changeComponent(t,e,n){return this.upsertComponent(t,e,n)}reset(t={}){this.order=t}upsertComponent(t,e,n){if(isNaN(n))return!1;if(this.order=this.order||{},this.order[t]=this.order[t]||{},"number"==typeof this.order[t][e]){if(isFinite(this.order[t][e])&&this.order[t][e]<=n){const s=0;return!(n>u()+s||(this.order[t][e]=n,0))}return!1}return this.order[t][e]=n,!0}}class Ft{constructor(t=!1){this.created={actors:{},components:{},entities:[],inputs:{}},this.removed={actors:{},components:{},entities:[]},this.updated={components:{}},this.symbols=[],this.isDiffed=t}actorInput(t,e){this.created.inputs[t]=this.created.inputs[t]||[],this.created.inputs[t].push(e)}changeComponent(t,e,n){return this.upsertComponent(t,e,n)}createEntity(t){this.created.entities.push(t)}removeActor(t){this.removed.actors[t]=!0}removeComponent(t,e){this.removed.components[t]=this.removed.components[t]||{},this.removed.components[t][e]=!0}removeEntity(t){this.removed.entities.push(t)}reset(){this.constructor()}spawnActor(t){this.created.actors[t]=!0}upsertComponent(t,e,n){const s="created"===t?this.created:this.updated;if(s){if("updated"===t&&this.created.components[e]&&this.created.components[e][n])return;s.components[e]=s.components[e]||{},s.components[e][n]=!0}}addSymbol(t){this.symbols.push(t)}replaceSymbols(t,e){if(t>0){const{length:n}=e,{symbols:s}=this;for(let o=0;o<n;o++){const n=e[o],i=o+t;s[i]=[n,i]}}else this.symbols=e.map(((t,e)=>[t,e]))}}class Tt{static ensure(t,e,n=ut){return t instanceof Tt?t:new Tt(t,e,n)}constructor(t={},e,n=ut){const{events:s=null,store:o=null,order:i=null,changes:r=null,symbols:c=null,pending:l=null}=t;e=Mt.ensure(e,e?.actions||zt);const{isOrdered:a,isDiffed:u,isReadOnly:m,compressStringsAsInts:h,enableQuerying:p,enumDefaultSymbols:d,storeOptions:f,indexes:y,types:g}=e;this.order=a?new qt(i):null,this.changes=u?new T(this,r):null,h?c?this.symbols=new H(c):(this.symbols=new H,this.symbols.copyEnum(d)):this.symbols=null,this.pending=m?null:l||new Ft(u),this.events=s,this.store=o||new n(void 0,{...f||{},types:g,indexes:p?y:null})}get actors(){const t=this.getActors(null,1/0);return t instanceof Q?t:t[0]}getActors(t,e){return this.store.getActors(t,e)}spawnActor(t,e){const{skipPending:n,isAsyncStorage:s,onUpdate:o}=e,i=this.store.storeActor(t),r=e=>{e&&(!n&&this.pending&&this.pending.spawnActor(t),this.events&&this.events.emit("spawnActor",t),o&&o())};return s&&i instanceof Promise?(i.then(r),i):(r(i),i)}removeActor(t,e){const{skipPending:n,isAsyncStorage:s,onUpdate:o}=e,i=this.store.destroyActor(t),r=e=>{e&&(!n&&this.pending&&this.pending.removeActor(t),this.events&&this.events.emit("removeActor",t),o&&o())};return s&&i instanceof Promise?(i.then(r),i):(r(i),i)}mergeActors(t,e){const{actions:n,isAsyncStorage:s,onUpdate:o}=e,i=e.extend({onUpdate:null}),r=[];for(const e of t){const t=n.spawnActor(e,this,i);s&&t instanceof Promise&&r.push(t)}const c=()=>{o&&o()};if(s&&r.length>0){const t=r.length?Promise.all(r):Promise.resolve([]);return t.then(c),t}c()}get entities(){const t=this.getEntities(null,1/0);return t instanceof Q?t:t[0]}getEntities(t,e){return this.store.getEntities(t,e)}createEntity(t,e){const{skipPending:n,isAsyncStorage:s,onUpdate:o}=e,i=this.store.storeEntity(t),r=e=>{e&&(!n&&this.pending&&this.pending.createEntity(t),this.events&&this.events.emit("createEntity",t),o&&o())};return s&&i instanceof Promise?(i.then(r),i):(r(i),i)}removeEntity(t,e){const{skipPending:n,isAsyncStorage:s,onUpdate:o}=e,i=this.store.destroyEntity(t),r=e=>{e&&(!n&&this.pending&&this.pending.removeEntity(t),this.events&&this.events.emit("removeEntity",t),o&&o())};return s&&i instanceof Promise?(i.then(r),i):(r(i),i)}mergeEntities(t,e){const{actions:n,isAsyncStorage:s,onUpdate:o}=e,i=e.extend({onUpdate:null}),r=[];for(const e of t){const t=n.createEntity(e,this,i);s&&t instanceof Promise&&r.push(t)}const c=()=>{o&&o()};if(s&&r.length>0){const t=r.length?Promise.all(r):Promise.resolve([]);return t.then(c),t}c()}get components(){const t=this.getComponents(null,1/0);return t instanceof Q?t:t[0]}getComponents(t,e){return this.store.getComponents(t,e)}changeComponent(t,e,n,s=0,o){const{actions:i,skipPending:r,isAsyncStorage:c,isGroupedComponents:l,getGroupedValue:a,types:u,onUpdate:m}=o,h=()=>{m&&m()};if(Array.isArray(t)||t instanceof Uint32Array){if(!l)throw new Error("Cannot change grouped components without isGroupedComponents option");const r=o.extend({onUpdate:null}),m=[];for(let o=0;o<t.length;o++){const l=a(n,o,u,e),h=i.changeComponent([t[o],e,l,s],this,r);c&&h instanceof Promise&&m.push(h)}if(c&&m.length>0){const t=m.length?Promise.all(m):Promise.resolve([]);return t.then(h),t}return void h()}const p=this.store.findComponent(t,e),d=o=>{const i=void 0===o?"created":"updated";if(this.order&&!this.order.changeComponent(t,e,s)&&!this.changes)return;let l;"created"===i?l=n:[,l]=v(o,n);let a=null;a=this.changes?this.changes.changeComponent(t,e,l,n,c):this.store.storeComponent(t,e,l);const u=()=>{!r&&this.pending&&this.pending.changeComponent(i,t,e),this.events&&this.events.emit("changeComponent",t,e),h()};if(c&&a instanceof Promise)return a.then(u),a;u()};return c&&p instanceof Promise?(p.then(d),p):(d(p),p)}upsertComponent(t,e,n,s=0,o){const{actions:i,skipPending:r,isAsyncStorage:c,isGroupedComponents:l,getGroupedValue:a,types:u,onUpdate:m}=o,h=()=>{m&&m()};if(Array.isArray(t)||t instanceof Uint32Array){if(!l)throw new Error("Cannot upsert grouped components without isGroupedComponents option");const r=o.extend({onUpdate:null}),m=[];for(let o=0;o<t.length;o++){const l=a(n,o,u,e),h=i.upsertComponent([t[o],e,l,s],this,r);c&&h instanceof Promise&&m.push(h)}if(c&&m.length>0){const t=m.length?Promise.all(m):Promise.resolve([]);return t.then(h),t}return void h()}const p=this.store.findComponent(t,e),d=o=>{if(o!==n){if(this.order&&!this.order.upsertComponent(t,e,s)&&!this.changes)return;let i=null;i=this.changes?this.changes.upsertComponent(t,e,n,o,c):this.store.storeComponent(t,e,n);const l=()=>{if(!r&&this.pending){const n=void 0===o?"created":"updated";this.pending.upsertComponent(n,t,e)}this.events&&this.events.emit("upsertComponent",t,e),h()};if(c&&i instanceof Promise)return i.then(l),i;l()}};return c&&p instanceof Promise?(p.then(d),p):(d(p),p)}removeComponent(t,e,n){const{skipPending:s,isAsyncStorage:o,onUpdate:i}=n,r=this.store.findComponent(t,e),c=n=>(void 0!==n||null!==n)&&(this.store.destroyComponent(t,e),!s&&this.pending&&this.pending.removeComponent(t,e),this.events&&this.events.emit("removeComponent",t,e),i&&i(),!0);return o&&r instanceof Promise?new Promise(((t,e)=>{r.then((e=>{t(c(e))}),e)})):c(r)}mergeComponents(t,e){const{actions:n,isAsyncStorage:s,isComponentRelay:o,onUpdate:i}=e,r=e.extend({skipPending:!o,onUpdate:null}),c=[];for(const e in t??{})for(const s in t[e]){const o=[e,s,t[e][s]],i=n.upsertComponent(o,this,r);i instanceof Promise&&c.push(i)}const l=()=>{i&&i()};if(s&&c.length>0){const t=c.length?Promise.all(c):Promise.resolve([]);return t.then(l),t}l()}get inputs(){const t=this.getInputs(null,1/0);return t instanceof Q?t:t[0]}getInputs(t,e){return this.store.getInputs(t,e)}actorInput(t,e,n=0,s){const{skipPending:o,isAsyncStorage:i,enableRollback:r,onUpdate:c}=s;n=r?n||u():0;const l=this.store.storeInput(t,e,n),a=s=>{!o&&this.pending&&this.pending.actorInput(t,s),this.events&&this.events.emit("actorInput",t,e,s,n),c&&c()};return i&&l instanceof Promise?(l.then(a),l):(a(l),l)}get symbolsList(){return this.symbols?.getSymbols()}get symbolsEnum(){return this.symbols?.getSymbolsEnum()}setSymbols(t){this.symbols?.reset(t)}getSymbol(t,e){const{actions:n}=e,s=this.symbols?.get(t);return s||n.fetchSymbol(s,this,e)[0]}addSymbol(t,e){if(null===this.symbols)return null;const{actions:n,isSymbolLeader:s,skipPending:o,onUpdate:i}=e,r=this.symbolsEnum??{};let c=Object.prototype.hasOwnProperty.call(r,t)?r[t]:-1;return-1===c&&(s?(c=this.symbols.add(t)??-1,!o&&this.pending&&this.pending.addSymbol([t,c]),i&&i()):n.fetchSymbol&&(c=n.fetchSymbol(t,this,e)[1])),-1===c?null:c}fetchSymbol(t,e,n){if(null===this.symbols)return null;const{isSymbolLeader:s,skipPending:o,onUpdate:i}=e,r=this.symbols.fetch(t);if(r[0]&&-1!==r[1])n&&n(r);else if(s){const t=this.symbols.add(r[0]);r[1]=t,!o&&this.pending&&this.pending.addSymbol(r),i&&i()}return r}mergeSymbol(t,e){if(null===this.symbols)return null;const{isSymbolLeader:n,isSymbolRelay:s,skipPending:o,onUpdate:i}=e;this.symbols.merge(t),(n||s)&&!o&&this.pending&&this.pending.addSymbol(t),i&&i()}resetSymbols(t=0,e,n){if(null===this.symbols)return null;const{isSymbolLeader:s,isSymbolRelay:o,skipPending:i,onUpdate:r}=n;this.symbols.reset(t,e),(s||o)&&!i&&this.pending&&this.pending.replaceSymbols(t,e),r&&r()}resetFrame(){this.pending&&this.pending.reset(),this.order&&this.order.reset(),this.changes&&this.changes.reset()}}class Qt extends _t{actors(){}components(){}entities(){}symbol(){}symbols(){}}const Ht={...Lt,actors:null,components:null,entities:null,symbol:null,symbols:null},Kt=Ht,Nt=bt;return e})()));
//# sourceMappingURL=lib.echo-d.min.js.map