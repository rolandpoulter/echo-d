"use strict";(Object("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).webpackChunkechoD=Object("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).webpackChunkechoD||[]).push([[939],{206:(t,e,n)=>{n.r(e),n.d(e,{id:()=>o});var r=new WeakMap,i=0,o=function(t){var e=r.get(t);return void 0!==e?e:(r.set(t,i),i++)}},837:(t,e,n)=>{function r(){var t=new Array;function e(e){t.push(e)}function n(){t.length=0}return e.clear=n,e.flush=function(){t.forEach((function(t){return t()})),n()},e}n.r(e),n.d(e,{createQueue:()=>r})},554:(t,e,n)=>{n.r(e),n.d(e,{Bucket:()=>s});var r,i=n(526);function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function u(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,u(r.key),r)}}function c(t,e,n){return(e=u(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}r=Symbol.iterator;var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),c(this,"_version",0),c(this,"onEntityAdded",new i.j),c(this,"onEntityRemoved",new i.j),c(this,"entityPositions",new Map),this._entities=e,this.add=this.add.bind(this),this.remove=this.remove.bind(this);for(var n=0;n<e.length;n++)this.entityPositions.set(e[n],n)}var e,n;return e=t,(n=[{key:"version",get:function(){return this._version}},{key:"entities",get:function(){return this._entities}},{key:r,value:function(){var t=this,e=this._entities.length,n={value:void 0,done:!1};return{next:function(){return n.value=t._entities[--e],n.done=e<0,n}}}},{key:"size",get:function(){return this.entities.length}},{key:"first",get:function(){return this.entities[0]}},{key:"has",value:function(t){return this.entityPositions.has(t)}},{key:"add",value:function(t){return t&&!this.has(t)&&(this.entities.push(t),this.entityPositions.set(t,this.entities.length-1),this._version++,this.onEntityAdded.emit(t)),t}},{key:"remove",value:function(t){if(this.has(t)){this.onEntityRemoved.emit(t);var e=this.entityPositions.get(t);this.entityPositions.delete(t);var n=this.entities[this.entities.length-1];n!==t&&(this.entities[e]=n,this.entityPositions.set(n,e)),this.entities.pop(),this._version++}return t}},{key:"clear",value:function(){var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,u=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw u}}}}(this);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.remove(n)}}catch(t){e.e(t)}finally{e.f()}}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}()},526:(t,e)=>{function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function r(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function i(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,i(r.key),r)}}var u=function(){function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,n="subscribers",r=new Set,(n=i(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r}var e,u;return e=t,u=[{key:"onSubscribe",get:function(){return this._onSubscribe||(this._onSubscribe=new t),this._onSubscribe}},{key:"onUnsubscribe",get:function(){return this._onUnsubscribe||(this._onUnsubscribe=new t),this._onUnsubscribe}},{key:"subscribe",value:function(t){var e,n=this;return this.subscribers.add(t),null===(e=this._onSubscribe)||void 0===e||e.emit(t),function(){return n.unsubscribe(t)}}},{key:"unsubscribe",value:function(t){var e;this.subscribers.delete(t),null===(e=this._onUnsubscribe)||void 0===e||e.emit(t)}},{key:"clear",value:function(){if(this._onUnsubscribe){var t,e=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=r(t))){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,u=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw u}}}}(this.subscribers);try{for(e.s();!(t=e.n()).done;){var n=t.value;this._onUnsubscribe.emit(n)}}catch(t){e.e(t)}finally{e.f()}}this.subscribers.clear()}},{key:"emit",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this.subscribers.forEach((function(t){return t.apply(void 0,e)}))}},{key:"emitAsync",value:function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return Promise.all((o=this.subscribers,function(t){if(Array.isArray(t))return n(t)}(o)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(o)||r(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(t){return t.apply(void 0,e)})));var o}}],u&&o(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),t}();e.j=u},939:(t,e,n)=>{t.exports=n(408)},408:(t,e,n)=>{var r,i=n(554),o=n(206),u=n(837);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function c(t,e){if(t){if("string"==typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function s(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function l(){return l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var i=Object.getOwnPropertyDescriptor(r,e);return i.get?i.get.call(arguments.length<3?t:n):i.value}},l.apply(this,arguments)}function y(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,u=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return u=t.done,t},e:function(t){a=!0,o=t},f:function(){try{u||null==n.return||n.return()}finally{if(a)throw o}}}}function h(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:String(e)}function v(t,e,n){return(e=h(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?d(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function p(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,h(r.key),r)}}function m(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function j(t,e){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},j(t,e)}function O(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&j(t,e)}function k(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var i=f(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}(this,n)}}var S=function(t){O(n,t);var e=k(n);function n(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return p(this,n),v(g(t=e.call(this,r)),"queries",new Set),v(g(t),"entityToId",new Map),v(g(t),"idToEntity",new Map),v(g(t),"nextId",0),t.onEntityAdded.subscribe((function(e){t.reindex(e)})),t.onEntityRemoved.subscribe((function(e){if(t.queries.forEach((function(t){return t.remove(e)})),t.entityToId.has(e)){var n=t.entityToId.get(e);t.idToEntity.delete(n),t.entityToId.delete(e)}})),t}return m(n,[{key:"update",value:function(t){function e(e,n,r){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e,n){if("function"==typeof e){var r=e(t);r&&Object.assign(t,r)}else"string"==typeof e?t[e]=n:e&&Object.assign(t,e);return this.reindex(t),t}))},{key:"addComponent",value:function(t,e,n){void 0===t[e]&&(t[e]=n,this.reindex(t))}},{key:"removeComponent",value:function(t,e){if(void 0!==t[e]){if(this.has(t)){var n=b({},t);delete n[e],this.reindex(t,n)}delete t[e]}}},{key:"query",value:function(t){var e,n=function(t){return{with:A(t.with),without:A(t.without),predicates:(e=t.predicates,s(new Set(e)))};var e}(t),r=_(n),i=y(this.queries);try{for(i.s();!(e=i.n()).done;){var o=e.value;if(o.key===r)return o}}catch(t){i.e(t)}finally{i.f()}var u=new P(this,n);return this.queries.add(u),u}},{key:"with",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.query({with:e,without:[],predicates:[]})}},{key:"without",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.query({with:[],without:e,predicates:[]})}},{key:"where",value:function(t){return this.query({with:[],without:[],predicates:[t]})}},{key:"reindex",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(this.has(t)){var n,r=y(this.queries);try{for(r.s();!(n=r.n()).done;)n.value.evaluate(t,e)}catch(t){r.e(t)}finally{r.f()}}}},{key:"id",value:function(t){if(this.has(t)){if(!this.entityToId.has(t)){var e=this.nextId++;this.entityToId.set(t,e),this.idToEntity.set(e,t)}return this.entityToId.get(t)}}},{key:"entity",value:function(t){return this.idToEntity.get(t)}}]),n}(i.Bucket);r=Symbol.iterator;var P=function(t){O(n,t);var e=k(n);function n(t,r){var i;return p(this,n),v(g(i=e.call(this)),"_isConnected",!1),i.world=t,i.config=r,i.key=_(r),i.onEntityAdded.onSubscribe.subscribe((function(){return i.connect()})),i.onEntityRemoved.onSubscribe.subscribe((function(){return i.connect()})),i}return m(n,[{key:"isConnected",get:function(){return this._isConnected}},{key:"entities",get:function(){return this._isConnected||this.connect(),l(f(n.prototype),"entities",this)}},{key:r,value:function(){return this._isConnected||this.connect(),l(f(n.prototype),Symbol.iterator,this).call(this)}},{key:"connect",value:function(){if(!this._isConnected){this._isConnected=!0;var t,e=y(this.world);try{for(e.s();!(t=e.n()).done;){var n=t.value;this.evaluate(n)}}catch(t){e.e(t)}finally{e.f()}}return this}},{key:"disconnect",value:function(){return this._isConnected=!1,this}},{key:"with",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.world.query(b(b({},this.config),{},{with:[].concat(s(this.config.with),e)}))}},{key:"without",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.world.query(b(b({},this.config),{},{without:[].concat(s(this.config.without),e)}))}},{key:"where",value:function(t){return this.world.query(b(b({},this.config),{},{predicates:[].concat(s(this.config.predicates),[t])}))}},{key:"want",value:function(t){return this.config.with.every((function(e){return void 0!==t[e]}))&&this.config.without.every((function(e){return void 0===t[e]}))&&this.config.predicates.every((function(e){return e(t)}))}},{key:"evaluate",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(this.isConnected){var n=this.want(e),r=this.has(t);n&&!r?this.add(t):!n&&r&&this.remove(t)}}}]),n}(i.Bucket),A=function(t){return s(new Set(t.sort().filter((function(t){return!!t&&""!==t}))))};function _(t){return"".concat(t.with.join(","),":").concat(t.without.join(","),":").concat(t.predicates.map((function(t){return o.id(t)})).join(","))}u.createQueue();e.World=S}}]);
//# sourceMappingURL=939.echo-d.min.js.map